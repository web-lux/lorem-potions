<%- include("./partials/head.ejs") %>
<body>
    <%- include("./partials/header.ejs") %>
    <div class="wrapper">
        <main class="details">
            <h1><%= decode(category.name) %></h1>
            <p><%= decode(category.description) %></p>
            <div class="hr"></div>
                <div class="user-actions">
                    
                    <% if (potions) { %>

                        <nav aria-label="potions navigation">
                            <ul>
                                <% potions.forEach(potion => { %>
                                    <li>
                                        <a href="/potions/<%= potion._id %>">
                                            <%= potion.name %>
                                        </a>
                                    </li>
                                <% }) %>
                            </ul>
                        </nav>
                        
                    <% } else { %>
                        <p>Aucune potion pour cette cat√©gorie.</p>
                    <% } %>
                    
                    <div class="user-buttons">

                        <a href="/categories/<%= category._id %>/modify">
                            <button class="btn primary">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M11.7583 13.0922L12.885 13.5868C13.1183 13.6892 13.3908 13.633 13.5648 13.4467C14.3752 12.5788 14.9788 11.5382 15.3301 10.4031C15.4059 10.1582 15.3187 9.89211 15.1126 9.74009L14.1172 9.00528C13.8329 8.796 13.6615 8.4643 13.6615 8.11154C13.6615 7.75885 13.8329 7.42715 14.1166 7.21826L15.1111 6.48378C15.3171 6.3317 15.4043 6.06561 15.3285 5.82085C14.9771 4.68549 14.3731 3.64481 13.5622 2.77709C13.388 2.59066 13.1154 2.53466 12.882 2.63738L11.76 3.13124C11.6195 3.19349 11.4692 3.2252 11.3173 3.22496C10.752 3.22436 10.2778 2.79816 10.2161 2.23544L10.0797 1.00987C10.0513 0.75426 9.86389 0.544984 9.61332 0.488995C9.03941 0.360752 8.45369 0.292678 7.86569 0.285889C7.26308 0.292834 6.67671 0.360876 6.10208 0.488923C5.85139 0.544789 5.66389 0.75413 5.63539 1.00987L5.49915 2.23451C5.46002 2.58494 5.25712 2.89627 4.95247 3.07334C4.64647 3.25246 4.27536 3.2739 3.95256 3.13196L2.83069 2.63818C2.59731 2.53546 2.32465 2.59147 2.15044 2.7779C1.33956 3.64561 0.735655 4.68629 0.38416 5.82163C0.308318 6.06659 0.395716 6.33281 0.601901 6.48483L1.59733 7.21885C1.88141 7.42794 2.04898 7.75963 2.04898 8.11239C2.04898 8.46509 1.88141 8.79678 1.59771 9.00561L0.601647 9.74087C0.395769 9.89283 0.308449 10.1587 0.384029 10.4035C0.734912 11.5398 1.3385 12.5817 2.14936 13.4506C2.32341 13.637 2.59594 13.6932 2.82935 13.5908L3.95623 13.0961C4.27747 12.9556 4.64704 12.9762 4.9514 13.152C5.25576 13.3278 5.45878 13.6379 5.49849 13.9876L5.63376 15.2112C5.66167 15.4639 5.84506 15.6717 6.09191 15.7306C7.25225 16.0072 8.46125 16.0072 9.6216 15.7306C9.86845 15.6717 10.0518 15.4639 10.0798 15.2112L10.2152 13.9858C10.2539 13.6354 10.4482 13.3244 10.7528 13.148C11.0574 12.9716 11.436 12.9509 11.7583 13.0922ZM7.85715 10.7206C6.41643 10.7206 5.24845 9.55265 5.24845 8.11194C5.24845 6.67122 6.41643 5.50324 7.85715 5.50324C9.29786 5.50324 10.4658 6.67122 10.4658 8.11194C10.4658 9.55265 9.29786 10.7206 7.85715 10.7206Z" />
                                  </svg>
                                Modify category
                            </button>
                        </a>

                        <button class="btn tertiary" id="delete" data-id="<%= category._id %>">
                            <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1.69697 12.32C1.69697 13.2474 2.45665 14 3.39394 14H9.05051C9.98723 14 10.7475 13.2474 10.7475 12.32L11.8788 3.36H0.565657L1.69697 12.32ZM7.91919 5.04H9.05051V12.32H7.91919V5.04ZM5.65657 5.04H6.78788V12.32H5.65657V5.04ZM3.39394 5.04H4.52525V12.32H3.39394V5.04ZM11.596 1.12H7.91919C7.91919 1.12 7.66578 0 7.35354 0H5.09091C4.7781 0 4.52525 1.12 4.52525 1.12H0.848485C0.379556 1.12 0 1.49576 0 1.96C0 2.42424 0 2.8 0 2.8H12.4444C12.4444 2.8 12.4444 2.42424 12.4444 1.96C12.4444 1.49576 12.0643 1.12 11.596 1.12Z" fill="#250131"/>
                            </svg>
                            Delete category
                        </button>

                    </div>

                </div>
        </main>
        <script>
            const deleteBtn = document.querySelector("#delete");
            deleteBtn.addEventListener("click", () => {
                const url = `/categories/${deleteBtn.dataset.id}`;
                fetch(url, { method: 'DELETE' })
                .then(res => res.json())
                .then(res => window.location.replace(res.redirect))
                .catch(err => console.log(err));
            });
        </script>
    </div>
</body>